TODO:

* more tests
* better handling of alternative return types (pdf, xml, etc)
